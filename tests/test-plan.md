# ヒルヨル テスト計画書

## ユーザーストーリー

### US-01: ゲストユーザーとしてランチを記録する
**役割**: ゲストユーザー
**目的**: ログインせずにランチを記録したい
**理由**: アプリを試してから登録を決めたいから

**受け入れ条件**:
- ログインなしでアプリを使用できる
- テキスト入力でランチを記録できる
- 記録したデータが端末に保存される
- 履歴画面で過去の記録を確認できる

### US-02: ログインユーザーとして写真でランチを記録する
**役割**: ログインユーザー
**目的**: 写真を撮るだけでランチを記録したい
**理由**: 手入力が面倒だから

**受け入れ条件**:
- カメラで写真を撮影できる
- ライブラリから写真を選択できる
- AIが写真から料理名を自動認識する
- 認識結果を手動で修正できる

### US-03: ログインユーザーとしておすすめディナーを取得する
**役割**: ログインユーザー
**目的**: ランチに基づいた夜ご飯の提案が欲しい
**理由**: 栄養バランスを考えた献立を決めたいから

**受け入れ条件**:
- ランチ記録後におすすめ画面でディナー提案を受けられる
- 3つのおすすめメニューが表示される
- おすすめ理由が表示される
- 選択したメニューをディナーとして記録できる

### US-04: ユーザーとして食事履歴を確認する
**役割**: 全ユーザー
**目的**: 過去の食事記録を振り返りたい
**理由**: 食生活を把握したいから

**受け入れ条件**:
- 過去の記録が日付順に表示される
- ランチとディナーが区別できる
- カテゴリが表示される

---

## 単体テスト

### UT-01: ローカルストレージフック
- `useLocalMeals` フックが正しく動作する
- 食事の追加・取得・削除ができる

### UT-02: 日付フォーマット関数
- `getTodayDate()` が正しいYYYY-MM-DD形式を返す

### UT-03: カテゴリデータ
- カテゴリ配列が4つの要素を持つ
- 各カテゴリにkey, label, emojiがある

---

## 結合テスト

### IT-01: 食事記録API
- `meals.create` が正しくDBに保存する
- `meals.getByDate` が正しくデータを取得する
- `meals.getRecent` が最新順でデータを返す

### IT-02: おすすめAPI
- `recommendations.getDinnerRecommendations` がLLMを呼び出す
- 3つのおすすめを返す
- 各おすすめにname, category, reasonがある

### IT-03: 画像解析API
- `imageAnalysis.analyzeFood` が画像をS3にアップロードする
- LLMで解析結果を返す

---

## 受け入れテスト

### AT-01: ゲストユーザーフロー
1. アプリを開く → ホーム画面が表示される
2. 「記録」タブをタップ → 記録画面が表示される
3. 料理名を入力 → 入力が反映される
4. カテゴリを選択 → 選択が反映される
5. 「記録する」をタップ → 記録完了アラートが表示される
6. 「履歴」タブをタップ → 記録した内容が表示される

### AT-02: ログインユーザーフロー
1. ログインする → ユーザー情報が表示される
2. 「記録」タブで写真を撮影 → AIが解析中表示
3. 解析完了 → 料理名・カテゴリが自動入力される
4. 「記録する」をタップ → サーバーに保存される
5. 「おすすめ」タブをタップ → ディナー提案が表示される
6. おすすめを選択 → ディナーとして記録される

### AT-03: エラーハンドリング
1. 空の料理名で記録 → エラーメッセージが表示される
2. ネットワークエラー時 → 適切なエラーメッセージが表示される
